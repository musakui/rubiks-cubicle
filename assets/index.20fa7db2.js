import{r as z,o as F,a as M,b as c,c as l,d as f,t as v,n as S,e as x,f as N,g as P,T as I,w as R,u as _,F as w,h as b,i as L,j as A,m as U,k as V}from"./vendor.15851fda.js";const j=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const i of t.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function a(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?t.credentials="include":e.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function r(e){if(e.ep)return;e.ep=!0;const t=a(e);fetch(e.href,t)}};j();const q="modulepreload",$={},G="/",J=function(s,a){return!a||a.length===0?s():Promise.all(a.map(r=>{if(r=`${G}${r}`,r in $)return;$[r]=!0;const e=r.endsWith(".css"),t=e?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${t}`))return;const i=document.createElement("link");if(i.rel=e?"stylesheet":q,e||(i.as="script",i.crossOrigin=""),i.href=r,document.head.appendChild(i),e)return new Promise((u,n)=>{i.addEventListener("load",u),i.addEventListener("error",n)})})).then(()=>s())},K=new Date("February 14, 2022 00:00:00").valueOf(),H=2**32,W=o=>()=>{let s=o+=1831565813;return s=Math.imul(s^s>>>15,s|1),s^=s+Math.imul(s^s>>>7,s|61),((s^s>>>14)>>>0)/H},Q=["","\u2032","\xB2"],O=[..."FBUDLR"],B=(o,s)=>Array.from({length:o},s),C=o=>new Promise(s=>setTimeout(s,o)),X=Math.floor((Date.now()-K)/864e5),Y=o=>{const s=parseInt(o),a=isNaN(s)?Math.random:W(s),r=n=>Math.floor(a()*n),e=(n,y)=>{let g=n;for(;g===n;)g=r(y);return g},t=[];let i,u=null;for(i=0;i<5;++i)u=e(u,6),t.push({letter:O[u],mod:Q[r(3)]});return t},Z=o=>{const s=()=>JSON.parse(JSON.stringify(o));return a=>{const r=s();for(const[e,t]of a.entries())r[e].letter===t.letter&&r[e].mod===t.mod&&(t.state=4,r[e]={});for(const[e,t]of a.entries())t.state||r[e].letter===t.letter&&(t.state=3,r[e].letter="");for(const e of a){if(e.state)continue;const t=r.find(i=>i.letter===e.letter);t?(e.state=2,t.letter=""):e.state=1}return a.every(e=>e.state===4)}};const ee={props:{moves:Array},setup(o){const s=o;let a=null;const r=z(null);return F(async()=>{const{createCube:e}=await J(()=>import("./cube.90b271a5.js").then(function(t){return t.e}),[]);a=e(r.value);for(const t of s.moves)await a.rotate(t.letter,t.mod?t.mod==="\u2032"?-1:2:1);for(let t=0;t<100;++t)await C(5),a.lights(t/100)}),M(()=>a==null?void 0:a.dispose()),(e,t)=>(c(),l("canvas",{ref_key:"canvasEl",ref:r},null,512))}};const te={props:{index:Number,state:Number,letter:String,mod:String},setup(o){const s=o,a=`${s.index*100}ms`,r=`${s.index*300}ms`,e=["","absent","present","gmod","correct"];return(t,i)=>(c(),l("div",{class:x(["tile",o.letter&&"filled",o.state&&"revealed"])},[f("div",{class:"front",style:S({transitionDelay:r})},v(o.letter)+v(o.mod),5),f("div",{class:x(["back",e[o.state]]),style:S({animationDelay:a,transitionDelay:r})},v(o.letter)+v(o.mod),7)],2))}};const se={key:0,class:"message"},re=f("header",null,[f("h1",null,"Rubik's Cubicle"),f("a",{id:"source",href:"https://github.com/musakui/rubiks-cubicle",target:"_blank"},"Source")],-1),ne={id:"board"},oe={id:"keyboard"},ae={class:"krow"},ie={key:0,class:"spacer"},ce=["onClick"],le={key:0},ue={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",height:"24",width:"24"},de={key:1,class:"spacer"},me={setup(o){let s=!0;const a=[O,["Enter","\u2032","2","Backspace"]],r=["Genius","Magnificent","Impressive","Splendid","Great","Phew"],e=`m22 3h-15c-1 0-1 0-2 1l-5 8 5 8c1 1 1 1 2 1h15c1 0 2-1 2-2v-14c0-1-1-2-2-2z
m0 16h-15l-5-7 5-7h15v14zm-12-2 4-4 4 4 1-1-4-4 4-4-1-1-4 4-4-4-1 1 4 4-4 4z`,t=Y(window.location.search.slice(1)||X),i=Z(t),u=N(B(6,()=>B(5,()=>({letter:"",mod:"",state:0})))),n=N({cur:0,shake:-1,done:!1,message:""}),y=d=>{for(const m of[...u[n.cur]].reverse())if(!!m.letter){d?m.mod=d:(m.mod="",m.letter="");break}},g=async()=>{const d=u[n.cur];if(!d.every(h=>h.letter)){s=!1,n.shake=n.cur,await C(1e3),s=!0,n.shake=-1;return}s=!1;const m=i(d);await C(1500),m?(n.message=r[n.cur],n.done=!0):n.cur<5?(++n.cur,s=!0):n.message=t.map(h=>`${h.letter}${h.mod}`).join(" ")},E=({key:d})=>{if(!!s)switch(d){case"Enter":g();break;case"Backspace":y();break;case"2":y("\xB2");break;case"`":case"\u2032":case"'":y("\u2032");break;default:if(!/^[bdflruBDFLRU]$/.test(d))return;for(const m of u[n.cur])if(!m.letter){m.letter=d.toUpperCase();return}}};return window.addEventListener("keyup",E),M(()=>window.removeEventListener("keyup",E)),(d,m)=>(c(),l(w,null,[P(I,null,{default:R(()=>[_(n).message?(c(),l("div",se,v(_(n).message),1)):L("",!0)]),_:1}),re,P(ee,{moves:_(t)},null,8,["moves"]),f("div",ne,[(c(!0),l(w,null,b(_(u),(h,k)=>(c(),l("div",{class:x(["row",_(n).shake===k&&"shake",_(n).done&&_(n).cur===k&&"jump"])},[(c(!0),l(w,null,b(h,(p,D)=>(c(),A(te,U(p,{index:D}),null,16,["index"]))),256))],2))),256))]),f("div",oe,[(c(),l(w,null,b(a,(h,k)=>f("div",ae,[k===1?(c(),l("div",ie)):L("",!0),(c(!0),l(w,null,b(h,p=>(c(),l("button",{class:x([p.length>1&&"big"]),onClick:D=>E({key:p})},[p!=="Backspace"?(c(),l("span",le,v(p),1)):(c(),l("svg",ue,[f("path",{d:e})]))],10,ce))),256)),k===1?(c(),l("div",de)):L("",!0)])),64))])],64))}},T=()=>document.body.style.setProperty("--vh",window.innerHeight+"px");T();window.addEventListener("resize",T);V(me).mount("#app");export{J as _};
